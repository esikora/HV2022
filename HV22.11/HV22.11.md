# Santa's Screenshot Render Function

*Writeup by: c16*

  * **Category**: Web Security
  * **Difficulty**: Medium
  * **Author**: Deaths Pirate

## Starting Point
The challenge starts at a web page (`https://hackvent.deathspirate.com`) with a form in which the user can enter a URL:

![Welcome page](images/welcome.png)

No other resources are provided.

## Functionality of the Web Page

When the user enters a URL and submits the form, the web server apparently performs the following steps:

* Access this URL
* Render the web page (internally)
* Convert (the upper part of) it to a bitmap image
* Store the rendered image in a web-accessible folder
* Send a web page with this image back to the user

We keep in mind that such a functionality gives rise to an SSRF (serve-side request forgery) attack. In addition, we can obtain some more information about the server by entering, for instance, `https://www.whatismybrowser.com/` into the form with the following result:

![Example request](images/whatismybrowser.png)

## Analysis of the HTML Source

Before we dive deeper into SSRF we should have a look at the HTML source. The source reveals that the static images are stored on `https://hackvent2022.s3.eu-west-2.amazonaws.com`, i.e. the Amazon simple storage service (Amazon S3). We can have a look at what is stored there simply by accessing that URL:

![S3 content](images/s3.png)

Bingo, one of the stored files is `flag1.txt`. We open the URL `https://hackvent2022.s3.eu-west-2.amazonaws.com/flag1.txt` to get its content:

```
Congratulations! You've found .... oh no wait

Santa told us that sometimes S3 buckets aren't so secure :/

We've added an extra step to make sure the flag doesn't get breached, we split it in two and put the other half somewhere .... Secret ;)

Here's the first half anyway:

HV22{H0_h0_h0_H4v3_&_
```

Now, we need to find the second half.

## Step 2

## Step 3

## The Flag

`HV22{}`

## Security Measures
